"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/login";
exports.ids = ["pages/api/auth/login"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "passport":
/*!***************************!*\
  !*** external "passport" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("passport");

/***/ }),

/***/ "passport-google-oauth20":
/*!******************************************!*\
  !*** external "passport-google-oauth20" ***!
  \******************************************/
/***/ ((module) => {

module.exports = require("passport-google-oauth20");

/***/ }),

/***/ "(api)/./libs/dbconnection.ts":
/*!******************************!*\
  !*** ./libs/dbconnection.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst dbconnect = async ()=>mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(process.env.MONGODB_URI + \"\", {\n        dbName: process.env.MONGODB_NAME\n    });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbconnect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWJzL2RiY29ubmVjdGlvbi50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFaEMsTUFBTUMsU0FBUyxHQUFHLFVBQVlELHVEQUFnQixDQUFDRyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsV0FBVyxHQUFDLEVBQUUsRUFBRTtRQUFDQyxNQUFNLEVBQUVILE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRyxZQUFZO0tBQUMsQ0FBQztBQUU5RyxpRUFBZU4sU0FBUyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmxvd2l0Ly4vbGlicy9kYmNvbm5lY3Rpb24udHM/OWMwYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuXG5jb25zdCBkYmNvbm5lY3QgPSBhc3luYyAoKSA9PiBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJKycnLCB7ZGJOYW1lOiBwcm9jZXNzLmVudi5NT05HT0RCX05BTUV9KTtcblxuZXhwb3J0IGRlZmF1bHQgZGJjb25uZWN0OyJdLCJuYW1lcyI6WyJtb25nb29zZSIsImRiY29ubmVjdCIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09EQl9VUkkiLCJkYk5hbWUiLCJNT05HT0RCX05BTUUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./libs/dbconnection.ts\n");

/***/ }),

/***/ "(api)/./libs/passport-google-auth.ts":
/*!**************************************!*\
  !*** ./libs/passport-google-auth.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var passport_google_oauth20__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! passport-google-oauth20 */ \"passport-google-oauth20\");\n/* harmony import */ var passport_google_oauth20__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(passport_google_oauth20__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var passport__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! passport */ \"passport\");\n/* harmony import */ var passport__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(passport__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/models/User */ \"(api)/./models/User.ts\");\n/* harmony import */ var _libs_dbconnection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/libs/dbconnection */ \"(api)/./libs/dbconnection.ts\");\n\n\n\n\n\n// logic to save your user or check if user exists in your record to proceed.\nconst getLoginInfo = async (user)=>{\n    try {\n        await (0,_libs_dbconnection__WEBPACK_IMPORTED_MODULE_4__[\"default\"])();\n        const usr = await _models_User__WEBPACK_IMPORTED_MODULE_3__[\"default\"].findOne({\n            email: user._json.email\n        });\n        if (usr) {\n            const loggedUser = {\n                name: usr.name,\n                email: usr.email,\n                phone: usr.phone\n            };\n            let token = await jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign(loggedUser, process.env.JWT_SECRET + \"\", {\n                expiresIn: \"1h\"\n            });\n            return {\n                registered: true,\n                token: token + \"\",\n                user: loggedUser\n            };\n        } else {\n            throw new Error(\"User not found\");\n        }\n    } catch (err) {\n        console.log(\"Mongodb Error\", err);\n        const googleUser = {\n            name: user.displayName,\n            email: user._json.email + \"\"\n        };\n        let token1 = await jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign(googleUser, process.env.JWT_SECRET + \"\", {\n            expiresIn: \"1h\"\n        });\n        return {\n            registered: false,\n            token: token1 + \"\",\n            user: googleUser\n        };\n    }\n};\npassport__WEBPACK_IMPORTED_MODULE_2___default().use(new passport_google_oauth20__WEBPACK_IMPORTED_MODULE_0__.Strategy({\n    clientID: process.env.GOOGLE_CLIENT_ID,\n    clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n    callbackURL: \"/api/oauth2/redirect/google\"\n}, async (_accessToken, _refreshToken, profile, done)=>{\n    try {\n        const { registered , token , user  } = await getLoginInfo(profile);\n        return done(null, user, {\n            token,\n            refreshToken: _refreshToken,\n            registered\n        });\n    } catch (e) {\n        console.log(\"Error\", e);\n        return done(e, undefined, {\n            message: \"Internal error\"\n        });\n    }\n}));\n// passport.serializeUser stores user object passed in the cb method above in req.session.passport\npassport__WEBPACK_IMPORTED_MODULE_2___default().serializeUser((user, cb)=>{\n    process.nextTick(function() {\n        return cb(null, user);\n    });\n});\n// passport.deserializeUser stores the user object in req.user\npassport__WEBPACK_IMPORTED_MODULE_2___default().deserializeUser(function(user, cb) {\n    process.nextTick(function() {\n        return cb(null, user);\n    });\n});\n// for broader explanation of serializeUser and deserializeUser visit https://stackoverflow.com/questions/27637609/understanding-passport-serialize-deserialize\n// An article that explains the concept of process.nextTick https://nodejs.dev/learn/understanding-process-nexttick\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((passport__WEBPACK_IMPORTED_MODULE_2___default()));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUksRUFBRW9DLEVBQUUsR0FBSztJQUNuQzFCLE9BQU8sQ0FBQzJCLFFBQVEsQ0FBQyxXQUFZO1FBQzNCLE9BQU9ELEVBQUUsQ0FBQyxJQUFJLEVBQUVwQyxJQUFJLENBQUMsQ0FBQztLQUN2QixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUM7QUFFSCw4REFBOEQ7QUFDOURKLCtEQUF3QixDQUFDLFNBQ3ZCSSxJQUFTLEVBQ1RvQyxFQUFrQyxFQUNsQztJQUNBMUIsT0FBTyxDQUFDMkIsUUFBUSxDQUFDLFdBQVk7UUFDM0IsT0FBT0QsRUFBRSxDQUFDLElBQUksRUFBRXBDLElBQUksQ0FBQyxDQUFDO0tBQ3ZCLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQztBQUVILCtKQUErSjtBQUUvSixtSEFBbUg7QUFFbkgsaUVBQWVKLGlEQUFRLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mbG93aXQvLi9saWJzL3Bhc3Nwb3J0LWdvb2dsZS1hdXRoLnRzPzIwMWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJvZmlsZSBhcyBHb29nbGVQcm9maWxlLCBWZXJpZnlDYWxsYmFjaywgU3RyYXRlZ3kgYXMgR29vZ2xlU3RyYXRlZ3kgfSBmcm9tIFwicGFzc3BvcnQtZ29vZ2xlLW9hdXRoMjBcIjtcbmltcG9ydCBKV1QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCBwYXNzcG9ydCBmcm9tIFwicGFzc3BvcnRcIjtcbmltcG9ydCBVc2VyIGZyb20gXCJAL21vZGVscy9Vc2VyXCI7XG5pbXBvcnQgeyBQcm9maWxlIH0gZnJvbSBcImVudGl0aWVzL1Byb2ZpbGVcIjtcbmltcG9ydCBkYmNvbm5lY3QgZnJvbSAnQC9saWJzL2RiY29ubmVjdGlvbic7XG5cbi8vIGxvZ2ljIHRvIHNhdmUgeW91ciB1c2VyIG9yIGNoZWNrIGlmIHVzZXIgZXhpc3RzIGluIHlvdXIgcmVjb3JkIHRvIHByb2NlZWQuXG5jb25zdCBnZXRMb2dpbkluZm8gPSBhc3luYyAodXNlcjogR29vZ2xlUHJvZmlsZSk6UHJvbWlzZTxhbnk+ID0+IHtcbiAgICB0cnl7ICAgICAgXG4gICAgICBhd2FpdCBkYmNvbm5lY3QoKTtcbiAgXG4gICAgICBjb25zdCB1c3IgPSBhd2FpdCBVc2VyLmZpbmRPbmUoe2VtYWlsOiB1c2VyLl9qc29uLmVtYWlsfSk7XG4gICAgICBpZih1c3IpeyAgICAgICAgXG4gICAgICAgIGNvbnN0IGxvZ2dlZFVzZXIgPSB7bmFtZTogdXNyLm5hbWUsIGVtYWlsOiB1c3IuZW1haWwsIHBob25lOiB1c3IucGhvbmV9O1xuICAgICAgICBsZXQgdG9rZW4gPSBhd2FpdCBKV1Quc2lnbihsb2dnZWRVc2VyLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKycnLCB7IGV4cGlyZXNJbjogXCIxaFwiIH0pO1xuICAgICAgICByZXR1cm4gKHtyZWdpc3RlcmVkOiB0cnVlLCB0b2tlbjp0b2tlbisnJywgdXNlcjogbG9nZ2VkVXNlcn0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBub3QgZm91bmRcIik7XG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoKGVycil7XG4gICAgICBjb25zb2xlLmxvZyhcIk1vbmdvZGIgRXJyb3JcIiwgZXJyKTtcbiAgICAgIGNvbnN0IGdvb2dsZVVzZXIgPSB7bmFtZTogdXNlci5kaXNwbGF5TmFtZSwgZW1haWw6IHVzZXIuX2pzb24uZW1haWwrJyd9O1xuICAgICAgbGV0IHRva2VuID0gYXdhaXQgSldULnNpZ24oZ29vZ2xlVXNlciwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCsnJywgeyBleHBpcmVzSW46IFwiMWhcIiB9KTtcbiAgICAgIHJldHVybiAoe3JlZ2lzdGVyZWQ6IGZhbHNlLCB0b2tlbjp0b2tlbisnJywgdXNlcjogZ29vZ2xlVXNlcn0pO1xuICAgIH1cbn07XG5cbnBhc3Nwb3J0LnVzZShcbiAgbmV3IEdvb2dsZVN0cmF0ZWd5KFxuICAgIHtcbiAgICAgIGNsaWVudElEOiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX0lEIGFzIHN0cmluZyxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQgYXMgc3RyaW5nLFxuICAgICAgY2FsbGJhY2tVUkw6IFwiL2FwaS9vYXV0aDIvcmVkaXJlY3QvZ29vZ2xlXCIsIC8vIHRoaXMgaXMgdGhlIGVuZHBvaW50IHlvdSByZWdpc3RlcmVkIG9uIGdvb2dsZSB3aGlsZSBjcmVhdGluZyB5b3VyIGFwcC4gVGhpcyBlbmRwb2ludCB3b3VsZCBleGlzdCBvbiB5b3VyIGFwcGxpY2F0aW9uIGZvciB2ZXJpZnlpbmcgdGhlIGF1dGhlbnRpY2F0aW9uLCAgICAgICAgICAgXG4gICAgfSxcbiAgICBhc3luYyAoX2FjY2Vzc1Rva2VuLCBfcmVmcmVzaFRva2VuLCBwcm9maWxlLCBkb25lOiBWZXJpZnlDYWxsYmFjaykgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qge3JlZ2lzdGVyZWQsIHRva2VuLCB1c2VyfSA9IGF3YWl0IGdldExvZ2luSW5mbyhwcm9maWxlKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkb25lKCBudWxsLCB1c2VyLCB7IHRva2VuLCByZWZyZXNoVG9rZW46IF9yZWZyZXNoVG9rZW4sIHJlZ2lzdGVyZWQgfSk7XG4gICAgICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJFcnJvclwiLCBlKTtcbiAgICAgICAgcmV0dXJuIGRvbmUoZSwgdW5kZWZpbmVkLCB7bWVzc2FnZTogJ0ludGVybmFsIGVycm9yJ30pO1xuICAgICAgfVxuICAgIH1cbiAgKVxuKTtcblxuXG4vLyBwYXNzcG9ydC5zZXJpYWxpemVVc2VyIHN0b3JlcyB1c2VyIG9iamVjdCBwYXNzZWQgaW4gdGhlIGNiIG1ldGhvZCBhYm92ZSBpbiByZXEuc2Vzc2lvbi5wYXNzcG9ydFxucGFzc3BvcnQuc2VyaWFsaXplVXNlcigodXNlciwgY2IpID0+IHtcbiAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNiKG51bGwsIHVzZXIpO1xuICB9KTtcbn0pO1xuXG4vLyBwYXNzcG9ydC5kZXNlcmlhbGl6ZVVzZXIgc3RvcmVzIHRoZSB1c2VyIG9iamVjdCBpbiByZXEudXNlclxucGFzc3BvcnQuZGVzZXJpYWxpemVVc2VyKGZ1bmN0aW9uIChcbiAgdXNlcjogYW55LFxuICBjYjogKGFyZzA6IG51bGwsIGFyZzE6IGFueSkgPT4gYW55XG4pIHtcbiAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNiKG51bGwsIHVzZXIpO1xuICB9KTtcbn0pO1xuXG4vLyBmb3IgYnJvYWRlciBleHBsYW5hdGlvbiBvZiBzZXJpYWxpemVVc2VyIGFuZCBkZXNlcmlhbGl6ZVVzZXIgdmlzaXQgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjc2Mzc2MDkvdW5kZXJzdGFuZGluZy1wYXNzcG9ydC1zZXJpYWxpemUtZGVzZXJpYWxpemVcblxuLy8gQW4gYXJ0aWNsZSB0aGF0IGV4cGxhaW5zIHRoZSBjb25jZXB0IG9mIHByb2Nlc3MubmV4dFRpY2sgaHR0cHM6Ly9ub2RlanMuZGV2L2xlYXJuL3VuZGVyc3RhbmRpbmctcHJvY2Vzcy1uZXh0dGlja1xuXG5leHBvcnQgZGVmYXVsdCBwYXNzcG9ydDsiXSwibmFtZXMiOlsiU3RyYXRlZ3kiLCJHb29nbGVTdHJhdGVneSIsIkpXVCIsInBhc3Nwb3J0IiwiVXNlciIsImRiY29ubmVjdCIsImdldExvZ2luSW5mbyIsInVzZXIiLCJ1c3IiLCJmaW5kT25lIiwiZW1haWwiLCJfanNvbiIsImxvZ2dlZFVzZXIiLCJuYW1lIiwicGhvbmUiLCJ0b2tlbiIsInNpZ24iLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsInJlZ2lzdGVyZWQiLCJFcnJvciIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJnb29nbGVVc2VyIiwiZGlzcGxheU5hbWUiLCJ1c2UiLCJjbGllbnRJRCIsIkdPT0dMRV9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsImNhbGxiYWNrVVJMIiwiX2FjY2Vzc1Rva2VuIiwiX3JlZnJlc2hUb2tlbiIsInByb2ZpbGUiLCJkb25lIiwicmVmcmVzaFRva2VuIiwiZSIsInVuZGVmaW5lZCIsIm1lc3NhZ2UiLCJzZXJpYWxpemVVc2VyIiwiY2IiLCJuZXh0VGljayIsImRlc2VyaWFsaXplVXNlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./libs/passport-google-auth.ts\n");

/***/ }),

/***/ "(api)/./models/User.ts":
/*!************************!*\
  !*** ./models/User.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst UserSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    name: {\n        type: String,\n        required: true\n    },\n    email: {\n        type: String,\n        required: true,\n        unique: true\n    },\n    password: {\n        type: String,\n        required: true,\n        hidden: true\n    },\n    phone: {\n        type: String,\n        minlength: 6,\n        maxlength: 12\n    }\n});\nUserSchema.pre(\"save\", async function(next) {\n    const user = this;\n    if (!user.isModified(\"password\")) {\n        next();\n    }\n    console.log(\"User DB\", this);\n    try {\n        const salt = await bcrypt__WEBPACK_IMPORTED_MODULE_1___default().genSalt(10);\n        user.password = await bcrypt__WEBPACK_IMPORTED_MODULE_1___default().hash(user.password, salt);\n        next();\n    } catch  {\n        next(new Error(\"Error hashing password\"));\n    }\n});\nUserSchema.methods.comparePassword = function(candidatePassword) {\n    return bcrypt__WEBPACK_IMPORTED_MODULE_1___default().compare(candidatePassword, this.password);\n};\nUserSchema.statics.findByEmail = async function(email) {\n    const usr = await mongoose__WEBPACK_IMPORTED_MODULE_0__.models.User.findOne({\n        email\n    });\n    if (!usr) throw new Error(\"User not found\");\n    return usr;\n};\nconst User = mongoose__WEBPACK_IMPORTED_MODULE_0__.models.User || (0,mongoose__WEBPACK_IMPORTED_MODULE_0__.model)(\"User\", UserSchema);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (User);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvVXNlci50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFpRDtBQUNyQjtBQUU1QixNQUFNSSxVQUFVLEdBQUcsSUFBSUosNENBQU0sQ0FBQztJQUM1QkssSUFBSSxFQUFFO1FBQ0pDLElBQUksRUFBRUMsTUFBTTtRQUNaQyxRQUFRLEVBQUUsSUFBSTtLQUNmO0lBQ0RDLEtBQUssRUFBRTtRQUNMSCxJQUFJLEVBQUVDLE1BQU07UUFDWkMsUUFBUSxFQUFFLElBQUk7UUFDZEUsTUFBTSxFQUFFLElBQUk7S0FDYjtJQUNEQyxRQUFRLEVBQUU7UUFDUkwsSUFBSSxFQUFFQyxNQUFNO1FBQ1pDLFFBQVEsRUFBRSxJQUFJO1FBQ2RJLE1BQU0sRUFBRSxJQUFJO0tBQ2I7SUFDREMsS0FBSyxFQUFFO1FBQ0xQLElBQUksRUFBRUMsTUFBTTtRQUNaTyxTQUFTLEVBQUUsQ0FBQztRQUNaQyxTQUFTLEVBQUUsRUFBRTtLQUNkO0NBQ0YsQ0FBQztBQUVGWCxVQUFVLENBQUNZLEdBQUcsQ0FBQyxNQUFNLEVBQUUsZUFBZ0JDLElBQUksRUFBRTtJQUN6QyxNQUFNQyxJQUFJLEdBQUcsSUFBSTtJQUVqQixJQUFJLENBQUNBLElBQUksQ0FBQ0MsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1FBQzlCRixJQUFJLEVBQUUsQ0FBQztLQUNWO0lBQ0RHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUU3QixJQUFHO1FBQ0MsTUFBTUMsSUFBSSxHQUFHLE1BQU1uQixxREFBYyxDQUFDLEVBQUUsQ0FBQztRQUNyQ2UsSUFBSSxDQUFDUCxRQUFRLEdBQUcsTUFBTVIsa0RBQVcsQ0FBQ2UsSUFBSSxDQUFDUCxRQUFRLEVBQUVXLElBQUksQ0FBQyxDQUFDO1FBRXZETCxJQUFJLEVBQUUsQ0FBQztLQUNWLFFBQUs7UUFDRkEsSUFBSSxDQUFDLElBQUlRLEtBQUssQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUM7S0FDN0M7Q0FDSixDQUFDLENBQUM7QUFDSHJCLFVBQVUsQ0FBQ3NCLE9BQU8sQ0FBQ0MsZUFBZSxHQUFHLFNBQVVDLGlCQUF5QixFQUFFO0lBQ3RFLE9BQU96QixxREFBYyxDQUFDeUIsaUJBQWlCLEVBQUUsSUFBSSxDQUFDakIsUUFBUSxDQUFDLENBQUM7Q0FDM0Q7QUFDRFAsVUFBVSxDQUFDMEIsT0FBTyxDQUFDQyxXQUFXLEdBQUcsZUFBZXRCLEtBQWEsRUFBRTtJQUM3RCxNQUFNdUIsR0FBRyxHQUFHLE1BQU05Qix5REFBbUIsQ0FBQztRQUFDTyxLQUFLO0tBQUMsQ0FBQztJQUM5QyxJQUFHLENBQUN1QixHQUFHLEVBQUUsTUFBTSxJQUFJUCxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUMzQyxPQUFPTyxHQUFHLENBQUM7Q0FDWjtBQUVELE1BQU1DLElBQUksR0FBRy9CLGlEQUFXLElBQUlELCtDQUFLLENBQUMsTUFBTSxFQUFFRyxVQUFVLENBQUM7QUFHckQsaUVBQWU2QixJQUFJLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mbG93aXQvLi9tb2RlbHMvVXNlci50cz82ZGM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNjaGVtYSwgbW9kZWwsIG1vZGVscyB9IGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0JztcblxuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBuYW1lOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB1bmlxdWU6IHRydWUsXG4gIH0sXG4gIHBhc3N3b3JkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIGhpZGRlbjogdHJ1ZSxcbiAgfSxcbiAgcGhvbmU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgbWlubGVuZ3RoOiA2LFxuICAgIG1heGxlbmd0aDogMTIsXG4gIH1cbn0pO1xuXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgY29uc3QgdXNlciA9IHRoaXM7XG5cbiAgICBpZiAoIXVzZXIuaXNNb2RpZmllZCgncGFzc3dvcmQnKSkge1xuICAgICAgICBuZXh0KCk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwiVXNlciBEQlwiLCB0aGlzKTtcblxuICAgIHRyeXtcbiAgICAgICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEwKTtcbiAgICAgICAgdXNlci5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHVzZXIucGFzc3dvcmQsIHNhbHQpO1xuXG4gICAgICAgIG5leHQoKTtcbiAgICB9Y2F0Y2h7XG4gICAgICAgIG5leHQobmV3IEVycm9yKCdFcnJvciBoYXNoaW5nIHBhc3N3b3JkJykpO1xuICAgIH1cbn0pO1xuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGZ1bmN0aW9uIChjYW5kaWRhdGVQYXNzd29yZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKGNhbmRpZGF0ZVBhc3N3b3JkLCB0aGlzLnBhc3N3b3JkKTtcbn1cblVzZXJTY2hlbWEuc3RhdGljcy5maW5kQnlFbWFpbCA9IGFzeW5jIGZ1bmN0aW9uKGVtYWlsOiBzdHJpbmcpIHtcbiAgY29uc3QgdXNyID0gYXdhaXQgbW9kZWxzLlVzZXIuZmluZE9uZSh7ZW1haWx9KTtcbiAgaWYoIXVzcikgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICByZXR1cm4gdXNyO1xufVxuXG5jb25zdCBVc2VyID0gbW9kZWxzLlVzZXIgfHwgbW9kZWwoJ1VzZXInLCBVc2VyU2NoZW1hKTtcblxuXG5leHBvcnQgZGVmYXVsdCBVc2VyOyJdLCJuYW1lcyI6WyJTY2hlbWEiLCJtb2RlbCIsIm1vZGVscyIsImJjcnlwdCIsIlVzZXJTY2hlbWEiLCJuYW1lIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwiZW1haWwiLCJ1bmlxdWUiLCJwYXNzd29yZCIsImhpZGRlbiIsInBob25lIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwicHJlIiwibmV4dCIsInVzZXIiLCJpc01vZGlmaWVkIiwiY29uc29sZSIsImxvZyIsInNhbHQiLCJnZW5TYWx0IiwiaGFzaCIsIkVycm9yIiwibWV0aG9kcyIsImNvbXBhcmVQYXNzd29yZCIsImNhbmRpZGF0ZVBhc3N3b3JkIiwiY29tcGFyZSIsInN0YXRpY3MiLCJmaW5kQnlFbWFpbCIsInVzciIsIlVzZXIiLCJmaW5kT25lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./models/User.ts\n");

/***/ }),

/***/ "(api)/./pages/api/auth/login.ts":
/*!*********************************!*\
  !*** ./pages/api/auth/login.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Login)\n/* harmony export */ });\n/* harmony import */ var _libs_passport_google_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/libs/passport-google-auth */ \"(api)/./libs/passport-google-auth.ts\");\n\nasync function Login(req, res, next) {\n    console.log(\"Authenticate\");\n    _libs_passport_google_auth__WEBPACK_IMPORTED_MODULE_0__[\"default\"].authenticate(\"google\", {\n        scope: [\n            \"profile\",\n            \"email\"\n        ],\n        session: false\n    })(req, res, next);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXV0aC9sb2dpbi50cy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFtRDtBQUVwQyxlQUFlQyxLQUFLLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDbERDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQzVCTiwrRUFBcUIsQ0FBQyxRQUFRLEVBQUU7UUFDOUJRLEtBQUssRUFBRTtZQUFDLFNBQVM7WUFBRSxPQUFPO1NBQUM7UUFDM0JDLE9BQU8sRUFBRSxLQUFLO0tBQ2YsQ0FBQyxDQUFDUCxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxDQUFDLENBQUM7Q0FDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mbG93aXQvLi9wYWdlcy9hcGkvYXV0aC9sb2dpbi50cz83NDRkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXNzcG9ydCBmcm9tIFwiQC9saWJzL3Bhc3Nwb3J0LWdvb2dsZS1hdXRoXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIExvZ2luKHJlcSwgcmVzLCBuZXh0KSB7XG4gIGNvbnNvbGUubG9nKFwiQXV0aGVudGljYXRlXCIpO1xuICBwYXNzcG9ydC5hdXRoZW50aWNhdGUoXCJnb29nbGVcIiwge1xuICAgIHNjb3BlOiBbXCJwcm9maWxlXCIsIFwiZW1haWxcIl0sXG4gICAgc2Vzc2lvbjogZmFsc2UsXG4gIH0pKHJlcSwgcmVzLCBuZXh0KTtcbn0iXSwibmFtZXMiOlsicGFzc3BvcnQiLCJMb2dpbiIsInJlcSIsInJlcyIsIm5leHQiLCJjb25zb2xlIiwibG9nIiwiYXV0aGVudGljYXRlIiwic2NvcGUiLCJzZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/login.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/auth/login.ts"));
module.exports = __webpack_exports__;

})();